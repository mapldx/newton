<div align="center">
    <div>
        <img src="https://raw.githubusercontent.com/mapldx/newton/main/examples/cover-example.png"/>
        <h1 align="center">ðŸ¦Š newton</h1>
    </div>
	<p>A CLI that creates your API documentation for you with AI</p>
	<a href="https://www.npmjs.com/package/newton-aidocs">
            <img alt="NPM Version" src="https://img.shields.io/npm/v/newton-aidocs">
    	</a>
    <img alt="GitHub Release Date" src="https://img.shields.io/github/release-date/mapldx/newton">
</div>

## Example
### Node.js (Express) project 
_[showing input and outputs]_
<li>
    <summary><code>index.js</code> as source (input) file:</summary>
    <br>

    const express = require('express');
    const app = express();

    app.post('/users', (req, res) => {
        const { username, email } = req.body;

        res.status(200).json({ message: 'User created successfully', username, email });
        if (!username || !email) {
            res.status(400).send('Missing required arguments');
        }
    });
    .
    .
    .
    [full source in examples/express-app/index.js]
</li>
<li>
    <summary><code>npx newton</code> exported (output) to Next.js site:</summary>
    <br>
<table>
  <tr>
    <td colspan="2" align="center">Preview page here: <a href="https://newton-next-export.surge.sh/" target="_blank">https://newton-next-export.surge.sh/</a></td>
  </tr>
  <tr>
    <th align="center">Light</th>
    <th align="center">Dark</th>
  </tr>
  <tr>
    <td><img src="https://github.com/mapldx/newton/blob/main/examples/next-light-mode.png?raw=true"></td>
    <td><img src="https://github.com/mapldx/newton/blob/main/examples/next-dark-mode.png?raw=true"></td>
  </tr>
</table>
</li>
<li>
    <code>npx newton</code> exported to simple HTML page [<a href="https://github.com/mapldx/newton/blob/main/examples/express-app/api-documentation.html">source</a>, <a href="https://github.com/mapldx/newton/blob/main/examples/express-simple-html.png?raw=true">preview</a>]
<li>
    <code>npx newton</code> exported to Markdown [<a href="https://github.com/mapldx/newton/blob/main/examples/express-app/api-documentation.md">preview</a>]
</li>
<li>
    <code>npx newton</code> exported to JSON [<a href="https://github.com/mapldx/newton/blob/main/examples/express-app/api-documentation.json">source</a>]
</li>

## Set up
### Installing
1. Install `newton` globally:
```
npm install -g newton-aidocs
```
2. Perform first time set up by configuring `newton` with an OpenAI API key that has billing set up:
```
npx newton
```
> Note: This creates a `.newton` file in your home directory where this API key, along with any other future customizable newton configurations, is stored.
### Updating
1. Check the version you have installed:
```
npx newton --version
```
2. If it is not equivalent to the latest version:
```
npm update -g newton-aidocs
```

## Usage
To start an interactive prompt to provide `newton` with the details to generate the documentation for your API:
```
npx newton
```
If you have an existing `api-documentation.json` file previously generated by `newton` and want to export it to another `newton` format (i.e. Markdown, HTML, Next.js):
```
npx newton -t
```

## Changelog
<details open>
    <summary><b><i>stable</i></b></summary>
    <ul>
	<li><code>1.0.8</code></li>
	<ul>
	    <li>in default mode, validate filepath as it is input to ensure that it exists and is of the expected <code>.js</code> or <code>.py</code> format</li>
	</ul>
    </ul>
    <ul>
        <li><code>1.0.7</code>
            <ul>
                <li>updated interactive prompts for enhanced reliability and user flexibility:
                    <ul>
                        <li>in default mode, now directly prompts for entrypoint filepath rather than project directory</li>
                        <li>in transmogrify mode, now directly prompts for the newton-generated JSON filepath rather than project directory</li>
			<li>in transmogrify mode, validate filepath as it is input to ensure that it exists and is of the expected <code>.json</code> format</li>
                    </ul>
                </li>
                <li>fixes for Next export:
                    <ul>
                        <li>added a prompt for base URL in transmogrify mode as it previously resulted in an undefined value</li>
                        <li>modified code block for copy button to remain static while scrolling</li>
                        <li>increased font size for endpoint titles</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</details>
<details>
    <summary><b><i>pre-releases (beta)</i></b></summary>
    <ul>
    	<li><code>1.0.6</code></li>
    	<li><code>1.0.5</code></li>
    	<li><code>1.0.4</code>:
            <ul>
            	<li>add search functionality on Next generated site, searching by endpoint title</li>
            	<li>add dark color scheme as an option for exporting Next generated site</li>
            	<li>add <code>npx newton -t</code> option to allow converting of previously generated or existing newton-generated JSON to other export options</li>
            </ul>
    	</li>
    	<li><code>1.0.3</code></li>
    	<li><code>1.0.2</code>:
            <ul>
            	<li>add functionality to export generated documentation to responsive Next.js site</li>
            	<li>add tab autocompletion for specifying project directory path</li>
            </ul>
    	</li>
    	<li><code>1.0.1</code>:
            <ul>
                <li>add support for Flask (Python) projects</li>
                <li>allow user to specify their own OpenAI API key for saved locally for persistent use</li>
            </ul>
    	</li>
    	<li><code>1.0.0</code>:
            <ul>
                <li>add functionality to generate documentation in JSON, Markdown, and HTML for Express.js (Node.js) APIs using GPT-3.5 Turbo</li>
            </ul>
    	</li>
    </ul>
</details>

## Specifications
1. For **Express.js (Node.js)** projects, `newton` works best when:
- the input file contains Express.js routes, e.g. where each route begins on a new line with `app.{get, post, put, delete}`:
```
const express = require('express')
const app = express()
const port = 80

app.use(express.json());

app.post('/api/auth', async (req, res) => {
  const uid = req.body.uid;
  const user = db.collection('users').doc(uid);

  await user.set({
    uid: uid,
    last_login: Timestamp.now(),
  });

  res.send('Logged in user with uid ' + uid);
});
.
.
.
```
2. For **Flask (Python)** projects, `newton` works best when:
- the input file contains the Flask routes, e.g. where each route begins on a new line with `@app.route`:
```
from flask import Flask, request
.
.
.
app = Flask(__name__)

@app.route("/user/metadata", methods=['GET'])
def get_user():
    email = request.args.get('email')
    user = users.get_user(email)
    return user, 200

@app.route("/user/create", methods=['POST'])
def create_user():
    email = request.args.get('email')
    role = request.args.get('role')
    if role not in ["staff"]:
        return "Invalid role", 400
    user_created = users.create_user(email, role)
    return user_created, 200
.
.
.
```
> Note: The files mentioned above are provided for illustrative purposes only and do not guarantee functionality. However, their formats served as a guideline for Newton's parsing functionalities.

## What is `transmogrify`?
<img src="https://github.com/mapldx/newton/blob/main/examples/transmogrifier-comic.png?raw=true">
